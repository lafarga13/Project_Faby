
# Differential Expression Analysis with Cgigas# Download data using your terminal$ curl -O -k https://raw.githubusercontent.com/sr320/austral/master/modules/data/Cgigas-HS-count.txt  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current                                 Dload  Upload   Total   Spent    Left  Speed100  863k  100  863k    0     0   268k      0  0:00:03  0:00:03 --:--:--  268k$ lsCgigas-HS-count.txt	GitHub.app		RCurso_Chile_Enero2015	Mou.app			R2014b_maci64.isoDia3			Project_Faby$ head Cgigas-HS-count.txt Feature ID	2M-Total	4M-Total	6m-Total	2M-HS-Total	4M-HS-Total	6M-HS-TotalCGI_10000001	25	26	35	56	10	35CGI_10000002	56	16	36	34	19	29CGI_10000003	0	19	25	6	79	8CGI_10000004	0	2	1	5	0	2CGI_10000005	0	0	0	0	0	0CGI_10000009	93	68	58	1384	1287	816CGI_10000010	185	195	254	762	774	1326CGI_10000011	31	2	10	131	19	17CGI_10000012	0	0	0	0	0	0# Download the software requiered for R studio> source("http://bioconductor.org/biocLite.R")> biocLite("DESeq2")> library(DESeq2)
> data <- read.table("/Users/alumnomatlab/Desktop/Project_Faby/Data/Cgigas-HS-count.txt", header = T, sep = "\t")> rownames(data) <- data$Feature> data <- data[,-1]# Build Objects# Specify which columns are in which groupsdeseq2.colData <- data.frame(condition=factor(c(rep ("Control", 3), rep("Treated ", 3))),                              type=factor(rep("single-read", 6)))rownames(deseq2.colData) <- colnames(data)deseq2.dds <- DESeqDataSetFromMatrix(countData = data,                                     colData = deseq2.colData,                                      design = ~ condition)# Run Analysisdeseq2.dds <- DESeq(deseq2.dds)deseq2.res <- results(deseq2.dds)deseq2.res <- deseq2.res[order(rownames(deseq2.res)), ]estimating size factorsestimating dispersionsgene-wise dispersion estimatesmean-dispersion relationshipfinal dispersion estimatesfitting model and testinhead(deseq2.res)log2 fold change (MAP): condition Treated vs Control Wald test p-value: condition Treated vs Control DataFrame with 6 rows and 6 columns               baseMean log2FoldChange     lfcSE       stat       pvalue         padj              <numeric>      <numeric> <numeric>  <numeric>    <numeric>    <numeric>CGI_10000001  31.577608      0.6109184 0.5772895  1.0582530 2.899401e-01 5.004287e-01CGI_10000002  31.411455      0.2376639 0.5525684  0.4301077 6.671173e-01 8.108845e-01CGI_10000003  27.843547      1.0103915 0.7971988  1.2674273 2.050025e-01 4.046120e-01CGI_10000004   1.634132      0.5839041 0.7983546  0.7313844 4.645444e-01           NACGI_10000005   0.000000             NA        NA         NA           NA           NACGI_10000009 736.886210      4.3733499 0.3622502 12.0727342 1.471621e-33 2.084212e-29# Count number of hits with adjusted p-value less then 0.05dim(deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ])[1] 3155    6tmp <- deseq2.res# The main plotplot(tmp$baseMean, tmp$log2FoldChange, pch=20, cex=0.45, ylim=c(-3, 3), log="x", col="darkgray",     main="DEG Temperature Exposure  (pval <= 0.05)",     xlab="mean of normalized counts",     ylab="Log2 Fold Change")# Getting the significant points and plotting them again so they're a different colortmp.sig <- deseq2.res[!is.na(deseq2.res$padj) & deseq2.res$padj <= 0.05, ]points(tmp.sig$baseMean, tmp.sig$log2FoldChange, pch=20, cex=0.45, col="green")# 2 FC linesabline(h=c(-1,1), col="blue")write.table(tmp.sig, "/Users/alumnomatlab/Desktop/Project_Faby/Output/Cgigas-DEGlist.tab", row.names = T)EN TERMINALMac-mini-de-Soporte-7:Desktop alumnomatlab$ head /Users/alumnomatlab/Desktop/Project_Faby/Output/Cgigas-DEGlist.tab"baseMean" "log2FoldChange" "lfcSE" "stat" "pvalue" "padj""CGI_10000009" 736.886209915701 4.37334992865392 0.362250162490774 12.0727342082705 1.47162084616685e-33 2.08421184058025e-29"CGI_10000010" 769.143993189777 2.60449988933177 0.527519621662233 4.9372568950609 7.92290759116334e-07 3.55524318631007e-05"CGI_10000014" 2158.70151550375 4.11456864340155 0.59729486695982 6.88867236436226 5.63154716087268e-12 1.05684341922263e-09"CGI_10000031" 31.0157398867365 2.4248707798534 0.555609891776035 4.36434054854959 1.27506813032109e-05 0.000350759651122873"CGI_10000034" 24.843960742004 -1.64653605236414 0.518699332037596 -3.17435545154085 0.00150169666866702 0.0142004191230825"CGI_10000038" 442.280996156497 -3.2730320074828 0.370725000968143 -8.82873288538762 1.05868217760233e-18 8.73701528024905e-16"CGI_10000039" 64.2870261580259 1.80826608969844 0.590338501028259 3.06310038486187 0.00219056562331056 0.0184470823083611"CGI_10000042" 3923.78207386192 3.06063357666479 0.66511815041146 4.60163893403209 4.19179403157936e-06 0.000139901125803961"CGI_10000044" 99.323294499693 1.0081548885518 0.352774900872264 2.85778519406867 0.00426609077288066 0.029733260680392
